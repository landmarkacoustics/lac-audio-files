# Copyright (C) 2021 by Landmark Acoustics LLC
r"""Keeps track of basic info about digital sound data."""

from .sample_format_info import SampleFormatInfo


class AudioFormatInfo:
    r"""You need at least this much information to store sounds digitally.

    Parameters
    ----------
    sample_info : SampleFormatInfo
        The details about how individual values are stored.
    sample_rate : int
        The number of samples per second in the data.
    channels : int, optional
        The number of channels in the data. The default is one.
    interleaved : bool, optional
        `True` (the default) when the data are grouped by time, not by channel.

    Attributes
    ----------
    Each of the parameters is stored as a property.

    See Also
    --------
    SampleFormatInfo : The first argument and property

    """

    def __init__(self,
                 sample_info: SampleFormatInfo,
                 sample_rate: int,
                 channels: int=1,
                 interleaved: bool=True) :

        self._format = sample_info
        self._Hz = sample_rate
        self._channels = channels
        self._interleaved = interleaved

    @property
    def sample_format(self) -> SampleFormatInfo:
        return self._format

    @property
    def sample_rate(self) -> int:
        return self._Hz

    @property
    def channels(self) -> int:
        return self._channels

    @property
    def interleaved(self) -> bool:
        return self._interleaved

    @property
    def bits_per_second(self) -> float:
        return self._format.bit_size * self._channels * self._Hz

    def __iter__(self) -> tuple:
        yield ('sample_format', dict(self.sample_format))
        yield ('sample_rate', self.sample_rate)
        yield ('channels', self.channels)
        yield ('interleaved', self.interleaved)

    def __repr__(self) -> str:
        return repr(dict(self))

    def __eq__(self, other: SampleFormatInfo) -> bool:
        return dict(self) == dict(other)
